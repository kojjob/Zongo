<%= form_with(model: [:admin, scheduled_transaction], class: "space-y-6") do |form| %>
  <% if scheduled_transaction.errors.any? %>
    <div class="bg-red-50 dark:bg-red-900/20 p-5 rounded-xl mb-8 border border-red-200 dark:border-red-800/30 relative overflow-hidden">
      <!-- Decorative elements -->
      <div class="absolute top-0 right-0 w-32 h-32 bg-red-500/5 rounded-full -mt-10 -mr-10"></div>
      <div class="absolute bottom-0 left-0 w-24 h-24 bg-red-500/5 rounded-full -mb-8 -ml-8"></div>

      <div class="flex items-start relative z-10">
        <div class="flex-shrink-0 bg-red-100 dark:bg-red-800/50 rounded-full p-2">
          <%= icon "exclamation-circle", class: "h-6 w-6 text-red-600 dark:text-red-400" %>
        </div>
        <div class="ml-4 flex-1">
          <h2 class="text-lg font-medium text-red-800 dark:text-red-300">
            <%= pluralize(scheduled_transaction.errors.count, "error") %> prohibited this transaction from being saved
          </h2>
          <div class="mt-3 space-y-2">
            <% scheduled_transaction.errors.full_messages.each do |message| %>
              <div class="flex items-center text-sm text-red-700 dark:text-red-400">
                <div class="w-1.5 h-1.5 bg-red-500 dark:bg-red-400 rounded-full mr-2 flex-shrink-0"></div>
                <span><%= message %></span>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Form sections with visual grouping -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Left column - Basic Information -->
    <div>
      <div class="mb-6">
        <h3 class="text-lg font-medium text-gray-900 dark:text-white flex items-center">
          <%= icon "document-text", class: "w-5 h-5 text-indigo-500 dark:text-indigo-400 mr-2" %>
          Basic Information
        </h3>
        <p class="text-sm text-gray-500 dark:text-gray-400">Define the core details of your scheduled transaction</p>
      </div>

      <div class="space-y-5">
        <!-- Description field with enhanced styling -->
        <div class="group">
          <label for="scheduled_transaction_description" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "annotation", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            Description
          </label>
          <div class="relative rounded-md shadow-sm transition-all duration-200 focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-opacity-50">
            <%= form.text_field :description, class: "block w-full rounded-md border-gray-300 pr-10 focus:border-indigo-500 focus:ring-0 dark:bg-gray-700 dark:border-gray-600 dark:text-white", placeholder: "Monthly rent payment" %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "pencil", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
        </div>

        <!-- Transaction Type with visual indicators -->
        <div class="group">
          <label for="scheduled_transaction_transaction_type" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "switch-horizontal", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            Transaction Type
          </label>
          <div class="relative">
            <%= form.select :transaction_type,
                ScheduledTransaction.transaction_types.keys.map { |type| [type.capitalize, type] },
                { include_blank: "Select transaction type" },
                { class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10" }
            %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "selector", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
        </div>

        <!-- Amount with currency symbol -->
        <div class="group">
          <label for="scheduled_transaction_amount" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "currency-dollar", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            Amount
          </label>
          <div class="relative rounded-md shadow-sm transition-all duration-200 focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-opacity-50">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <span class="text-gray-500 dark:text-gray-400 sm:text-sm">â‚µ</span>
            </div>
            <%= form.number_field :amount, step: "0.01", min: "0.01", class: "pl-7 block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-0 dark:bg-gray-700 dark:border-gray-600 dark:text-white", placeholder: "0.00" %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "cash", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
        </div>

        <!-- Status with colored indicators -->
        <div class="group">
          <label for="scheduled_transaction_status" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "status-online", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            Status
          </label>
          <div class="relative">
            <%= form.select :status,
                [
                  ["Active", "active", { "data-color": "green" }],
                  ["Paused", "paused", { "data-color": "yellow" }],
                  ["Completed", "completed", { "data-color": "blue" }],
                  ["Cancelled", "cancelled", { "data-color": "red" }]
                ],
                {},
                { class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10" }
            %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "selector", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right column - Schedule & Accounts -->
    <div>
      <div class="mb-6">
        <h3 class="text-lg font-medium text-gray-900 dark:text-white flex items-center">
          <%= icon "clock", class: "w-5 h-5 text-indigo-500 dark:text-indigo-400 mr-2" %>
          Schedule & Accounts
        </h3>
        <p class="text-sm text-gray-500 dark:text-gray-400">Set the timing and account details</p>
      </div>

      <div class="space-y-5">
        <!-- Frequency with visual indicators -->
        <div class="group">
          <label for="scheduled_transaction_frequency" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "refresh", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            Frequency
          </label>
          <div class="relative">
            <%= form.select :frequency,
                ScheduledTransaction.frequencies.keys.map { |freq| [freq.titleize, freq] },
                { include_blank: "Select frequency" },
                { class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10" }
            %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "selector", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
        </div>

        <!-- Next Occurrence with calendar icon -->
        <div class="group">
          <label for="scheduled_transaction_next_occurrence" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "calendar", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            Next Occurrence
          </label>
          <div class="relative rounded-md shadow-sm transition-all duration-200 focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-opacity-50">
            <%= form.datetime_field :next_occurrence, class: "block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-0 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10" %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "calendar", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
        </div>

        <!-- Occurrences Limit with counter icon -->
        <div class="group">
          <label for="scheduled_transaction_occurrences_limit" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "collection", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            Occurrences Limit <span class="text-xs text-gray-500 dark:text-gray-400 ml-1">(Optional)</span>
          </label>
          <div class="relative rounded-md shadow-sm transition-all duration-200 focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-opacity-50">
            <%= form.number_field :occurrences_limit, min: 1, class: "block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-0 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10", placeholder: "Leave blank for unlimited" %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "hashtag", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
          <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Leave blank for unlimited occurrences</p>
        </div>

        <!-- User selection with user icon -->
        <div class="group">
          <label for="scheduled_transaction_user_id" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            <%= icon "user", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
            User
          </label>
          <div class="relative">
            <%= form.collection_select :user_id,
                User.all,
                :id,
                :email,
                { include_blank: "Select user" },
                { class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10" }
            %>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <div class="text-gray-400 dark:text-gray-500">
                <%= icon "selector", class: "h-4 w-4" %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment Details Section -->
  <div class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-700">
    <div class="mb-6">
      <h3 class="text-lg font-medium text-gray-900 dark:text-white flex items-center">
        <%= icon "credit-card", class: "w-5 h-5 text-indigo-500 dark:text-indigo-400 mr-2" %>
        Payment Details
      </h3>
      <p class="text-sm text-gray-500 dark:text-gray-400">Configure source and destination accounts</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
      <!-- Source Wallet -->
      <div class="group">
        <label for="scheduled_transaction_source_wallet_id" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
          <%= icon "arrow-circle-up", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
          Source Wallet
        </label>
        <div class="relative">
          <%= form.collection_select :source_wallet_id,
              Wallet.all,
              :id,
              :name,
              { include_blank: "Select source wallet" },
              { class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10" }
          %>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
            <div class="text-gray-400 dark:text-gray-500">
              <%= icon "selector", class: "h-4 w-4" %>
            </div>
          </div>
        </div>
      </div>

      <!-- Destination Wallet -->
      <div class="group">
        <label for="scheduled_transaction_destination_wallet_id" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
          <%= icon "arrow-circle-down", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
          Destination Wallet <span class="text-xs text-gray-500 dark:text-gray-400 ml-1">(for transfers)</span>
        </label>
        <div class="relative">
          <%= form.collection_select :destination_wallet_id,
              Wallet.all,
              :id,
              :name,
              { include_blank: "Select destination wallet" },
              { class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10" }
          %>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
            <div class="text-gray-400 dark:text-gray-500">
              <%= icon "selector", class: "h-4 w-4" %>
            </div>
          </div>
        </div>
      </div>

      <!-- Payment Method -->
      <div class="group">
        <label for="scheduled_transaction_payment_method" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
          <%= icon "credit-card", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
          Payment Method <span class="text-xs text-gray-500 dark:text-gray-400 ml-1">(for deposits/withdrawals)</span>
        </label>
        <div class="relative rounded-md shadow-sm transition-all duration-200 focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-opacity-50">
          <%= form.text_field :payment_method, class: "block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-0 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10", placeholder: "e.g., Credit Card, Bank Transfer" %>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
            <div class="text-gray-400 dark:text-gray-500">
              <%= icon "credit-card", class: "h-4 w-4" %>
            </div>
          </div>
        </div>
      </div>

      <!-- Payment Destination -->
      <div class="group">
        <label for="scheduled_transaction_payment_destination" class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
          <%= icon "location-marker", class: "w-4 h-4 text-indigo-500 dark:text-indigo-400 mr-1.5 opacity-80 group-hover:opacity-100 transition-opacity" %>
          Payment Destination <span class="text-xs text-gray-500 dark:text-gray-400 ml-1">(for payments)</span>
        </label>
        <div class="relative rounded-md shadow-sm transition-all duration-200 focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-opacity-50">
          <%= form.text_field :payment_destination, class: "block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-0 dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-10", placeholder: "e.g., Utility Company, Rent" %>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
            <div class="text-gray-400 dark:text-gray-500">
              <%= icon "office-building", class: "h-4 w-4" %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Form Actions with enhanced styling -->
  <div class="mt-10 pt-6 border-t border-gray-200 dark:border-gray-700 flex flex-col-reverse sm:flex-row sm:justify-between sm:space-x-4">
    <div>
      <%= link_to admin_scheduled_transactions_path, class: "inline-flex items-center px-4 py-2.5 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-150 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:bg-gray-600" do %>
        <%= icon "x", class: "w-4 h-4 mr-2" %>
        Cancel
      <% end %>
    </div>

    <div class="mb-4 sm:mb-0">
      <%= button_tag type: "submit", class: "w-full sm:w-auto inline-flex items-center justify-center px-6 py-2.5 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-150 dark:from-indigo-500 dark:to-purple-500" do %>
        <%= icon "check", class: "w-4 h-4 mr-2" %>
        <%= scheduled_transaction.new_record? ? "Create Scheduled Transaction" : "Update Scheduled Transaction" %>
      <% end %>
    </div>
  </div>
<% end %>
