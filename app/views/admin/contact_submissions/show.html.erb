<% content_for :title, "Contact Submission" %>

<div class="space-y-6">
  <div class="flex justify-between items-center">
    <div class="flex items-center space-x-4">
      <%= link_to admin_contact_submissions_path, class: "text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 flex items-center" do %>
        <%= icon "arrow-left", class: "w-5 h-5 mr-1" %>
        Back to submissions
      <% end %>
      
      <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Contact Submission</h1>
    </div>
    
    <div class="flex space-x-3">
      <% unless @contact_submission.read? %>
        <%= button_to mark_as_read_admin_contact_submission_path(@contact_submission), method: :patch, class: "px-4 py-2 rounded-lg text-sm font-medium bg-indigo-600 text-white hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600" do %>
          Mark as Read
        <% end %>
      <% end %>
      
      <%= button_to admin_contact_submission_path(@contact_submission), method: :delete, class: "px-4 py-2 rounded-lg text-sm font-medium bg-red-600 text-white hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600", data: { confirm: "Are you sure you want to delete this message?" } do %>
        Delete
      <% end %>
    </div>
  </div>

  <div class="bg-white dark:bg-gray-800 shadow-md rounded-xl overflow-hidden">
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-xl font-semibold text-gray-900 dark:text-white">
            <%= @contact_submission.subject.present? ? @contact_submission.subject : "No subject" %>
          </h2>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
            Submitted <%= time_ago_in_words(@contact_submission.created_at) %> ago
          </p>
        </div>
        
        <div>
          <% if @contact_submission.read? %>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">
              Read <%= time_ago_in_words(@contact_submission.read_at) %> ago
            </span>
          <% else %>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300">
              Unread
            </span>
          <% end %>
        </div>
      </div>
    </div>
    
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Contact Information</h3>
          
          <div class="space-y-4">
            <div>
              <p class="text-sm font-medium text-gray-700 dark:text-gray-300">Name</p>
              <p class="text-base text-gray-900 dark:text-white"><%= @contact_submission.name %></p>
            </div>
            
            <div>
              <p class="text-sm font-medium text-gray-700 dark:text-gray-300">Email</p>
              <p class="text-base text-gray-900 dark:text-white">
                <a href="mailto:<%= @contact_submission.email %>" class="text-indigo-600 dark:text-indigo-400 hover:underline">
                  <%= @contact_submission.email %>
                </a>
              </p>
            </div>
            
            <% if @contact_submission.phone.present? %>
              <div>
                <p class="text-sm font-medium text-gray-700 dark:text-gray-300">Phone</p>
                <p class="text-base text-gray-900 dark:text-white">
                  <a href="tel:<%= @contact_submission.phone %>" class="text-indigo-600 dark:text-indigo-400 hover:underline">
                    <%= @contact_submission.phone %>
                  </a>
                </p>
              </div>
            <% end %>
          </div>
        </div>
        
        <div>
          <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Additional Information</h3>
          
          <div class="space-y-4">
            <div>
              <p class="text-sm font-medium text-gray-700 dark:text-gray-300">Terms Accepted</p>
              <p class="text-base text-gray-900 dark:text-white">
                <% if @contact_submission.terms? %>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300">
                    Yes
                  </span>
                <% else %>
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300">
                    No
                  </span>
                <% end %>
              </p>
            </div>
            
            <% if @contact_submission.terms_accepted_at.present? %>
              <div>
                <p class="text-sm font-medium text-gray-700 dark:text-gray-300">Terms Accepted At</p>
                <p class="text-base text-gray-900 dark:text-white">
                  <%= @contact_submission.terms_accepted_at.strftime("%B %d, %Y at %I:%M %p") %>
                </p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="p-6">
      <h3 class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-4">Message</h3>
      
      <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
        <p class="text-gray-900 dark:text-white whitespace-pre-wrap"><%= @contact_submission.message %></p>
      </div>
    </div>
  </div>
  
  <div class="flex justify-between">
    <div class="flex space-x-3">
      <%= link_to "Reply via Email", "mailto:#{@contact_submission.email}?subject=Re: #{@contact_submission.subject}", class: "px-4 py-2 rounded-lg text-sm font-medium bg-indigo-600 text-white hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600" %>
      
      <% if @contact_submission.phone.present? %>
        <%= link_to "Call", "tel:#{@contact_submission.phone}", class: "px-4 py-2 rounded-lg text-sm font-medium bg-green-600 text-white hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600" %>
      <% end %>
    </div>
    
    <div>
      <%= button_to admin_contact_submission_path(@contact_submission), method: :delete, class: "px-4 py-2 rounded-lg text-sm font-medium bg-red-600 text-white hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600", data: { confirm: "Are you sure you want to delete this message?" } do %>
        Delete
      <% end %>
    </div>
  </div>
</div>
