<% content_for :title, "Notifications" %>

<div class="space-y-6">
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Notifications</h1>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- New Users Section -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
      <div class="px-6 py-4 bg-indigo-50 dark:bg-indigo-900/20 border-b border-gray-200 dark:border-gray-700">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold text-gray-900 dark:text-white">New Users</h2>
          <% if @recent_users.present? %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300">
              <%= @recent_users.count %> recent
            </span>
          <% end %>
        </div>
      </div>
      <div class="divide-y divide-gray-200 dark:divide-gray-700">
        <% if @recent_users.present? %>
          <% @recent_users.each do |user| %>
            <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
              <div class="flex items-center">
                <div class="flex-shrink-0 mr-4">
                  <% if user.respond_to?(:avatar) && user.avatar.attached? %>
                    <%= image_tag user.avatar, class: "h-10 w-10 rounded-full", alt: "User avatar" %>
                  <% else %>
                    <div class="h-10 w-10 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-600 dark:text-indigo-300 font-semibold text-lg">
                      <%= (user.username.presence || user.email[0]).first.upcase %>
                    </div>
                  <% end %>
                </div>
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 dark:text-white truncate">
                    <%= user.username.presence || user.email %>
                  </p>
                  <p class="text-xs text-gray-500 dark:text-gray-400">
                    Joined <%= time_ago_in_words(user.created_at) %> ago
                  </p>
                </div>
                <div class="ml-4">
                  <%= link_to admin_user_path(user), class: "text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300" do %>
                    <%= icon "eye", class: "w-5 h-5" %>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        <% else %>
          <div class="p-6 text-center text-gray-500 dark:text-gray-400">
            <p>No new users</p>
          </div>
        <% end %>
      </div>
      <% if @recent_users.present? %>
        <div class="px-6 py-3 bg-gray-50 dark:bg-gray-700/50 text-center">
          <%= link_to admin_users_path, class: "text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 transition-colors" do %>
            View all users
            <%= icon "arrow-right", class: "inline-block w-3 h-3 ml-1" %>
          <% end %>
        </div>
      <% end %>
    </div>

    <% if defined?(Transaction) && @recent_transactions.present? %>
      <!-- Recent Transactions Section -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
        <div class="px-6 py-4 bg-green-50 dark:bg-green-900/20 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Recent Transactions</h2>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300">
              <%= @recent_transactions.count %> recent
            </span>
          </div>
        </div>
        <div class="divide-y divide-gray-200 dark:divide-gray-700">
          <% @recent_transactions.each do |transaction| %>
            <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
              <div class="flex items-center">
                <div class="flex-shrink-0 mr-4">
                  <div class="h-10 w-10 rounded-full flex items-center justify-center text-white font-semibold text-sm
                    <%= case transaction.transaction_type.to_s
                        when 'deposit'
                          'bg-green-500'
                        when 'withdrawal'
                          'bg-red-500'
                        when 'transfer'
                          'bg-blue-500'
                        else
                          'bg-gray-500'
                        end %>">
                    <%= transaction.transaction_type.to_s.first.upcase %>
                  </div>
                </div>
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 dark:text-white truncate">
                    <%= transaction.transaction_type.to_s.capitalize %>
                  </p>
                  <p class="text-xs text-gray-500 dark:text-gray-400">
                    <%= time_ago_in_words(transaction.created_at) %> ago
                  </p>
                </div>
                <div class="ml-4">
                  <span class="text-sm font-medium <%= transaction.transaction_type.to_s == 'deposit' ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400' %>">
                    <%= number_to_currency(transaction.amount, unit: 'â‚µ') %>
                  </span>
                </div>
              </div>
            </div>
          <% end %>
        </div>
        <div class="px-6 py-3 bg-gray-50 dark:bg-gray-700/50 text-center">
          <%= link_to admin_transactions_path, class: "text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 transition-colors" do %>
            View all transactions
            <%= icon "arrow-right", class: "inline-block w-3 h-3 ml-1" %>
          <% end %>
        </div>
      </div>
    <% end %>

    <% if defined?(Event) && @recent_events.present? %>
      <!-- Recent Events Section -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
        <div class="px-6 py-4 bg-blue-50 dark:bg-blue-900/20 border-b border-gray-200 dark:border-gray-700">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Recent Events</h2>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300">
              <%= @recent_events.count %> recent
            </span>
          </div>
        </div>
        <div class="divide-y divide-gray-200 dark:divide-gray-700">
          <% @recent_events.each do |event| %>
            <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
              <div class="flex items-center">
                <div class="flex-shrink-0 mr-4">
                  <% if event.event_media.present? && event.event_media.first.image.attached? %>
                    <%= image_tag event.event_media.first.image, class: "h-10 w-10 rounded-lg object-cover", alt: "Event image" %>
                  <% else %>
                    <div class="h-10 w-10 rounded-lg bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-600 dark:text-blue-300">
                      <%= icon "calendar", class: "w-6 h-6" %>
                    </div>
                  <% end %>
                </div>
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 dark:text-white truncate">
                    <%= event.title %>
                  </p>
                  <p class="text-xs text-gray-500 dark:text-gray-400">
                    Created <%= time_ago_in_words(event.created_at) %> ago
                  </p>
                </div>
                <div class="ml-4">
                  <%= link_to event_path(event), class: "text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300" do %>
                    <%= icon "eye", class: "w-5 h-5" %>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
        <div class="px-6 py-3 bg-gray-50 dark:bg-gray-700/50 text-center">
          <%= link_to admin_events_path, class: "text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 transition-colors" do %>
            View all events
            <%= icon "arrow-right", class: "inline-block w-3 h-3 ml-1" %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
