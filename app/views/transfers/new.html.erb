<%# Highly Visual Transfer Page for Various Literacy Levels %>
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8" data-controller="transfer" data-pin-verification-required-value="false" data-pin-verification-amount-value="0">
  <!-- Visual Header with Clear Purpose -->
  <div class="bg-gradient-to-r from-blue-600 to-indigo-700 rounded-2xl shadow-xl overflow-hidden mb-8">
    <div class="relative p-6 md:p-8">
      <!-- Back Button with Extra Visual Cues -->
      <a href="<%= wallet_path %>" class="absolute top-4 left-4 flex items-center justify-center w-12 h-12 rounded-full bg-white/20 text-white hover:bg-white/30 transition-all duration-300 shadow-md">
        <div class="flex flex-col items-center">
          <%= icon("arrow-left", class: "w-6 h-6") %>
          <span class="text-xs mt-1">Back</span>
        </div>
      </a>

      <!-- Decorative elements -->
      <div class="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mt-32 -mr-32 blur-3xl opacity-50"></div>
      <div class="absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full -mb-24 -ml-24 blur-2xl opacity-50"></div>
      
      <!-- Large Visual Icon -->
      <div class="flex justify-center mb-4 mt-10">
        <div class="w-24 h-24 rounded-full bg-white/30 backdrop-blur-sm flex items-center justify-center shadow-xl">
          <%= icon("send", class: "w-12 h-12 text-white") %>
        </div>
      </div>

      <!-- Clear Title and Description -->
      <div class="text-center">
        <h1 class="text-3xl font-bold text-white">Send Money</h1>
        <p class="mt-2 text-xl text-white/90 max-w-md mx-auto">
          Transfer money to friends and family
        </p>
      </div>

      <!-- Visual Transaction Types -->
      <div class="grid grid-cols-3 gap-4 mt-8 max-w-md mx-auto">
        <div class="bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center transform transition hover:scale-105 border-2 border-white/40 cursor-pointer shadow-lg">
          <div class="w-12 h-12 rounded-full bg-blue-500 mx-auto flex items-center justify-center mb-2">
            <%= icon("users", class: "w-6 h-6 text-white") %>
          </div>
          <p class="text-sm font-bold text-white">To Friends</p>
        </div>
        
        <div class="bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center transform transition hover:scale-105 border-2 border-white/40 cursor-pointer shadow-lg">
          <div class="w-12 h-12 rounded-full bg-purple-500 mx-auto flex items-center justify-center mb-2">
            <%= icon("home", class: "w-6 h-6 text-white") %>
          </div>
          <p class="text-sm font-bold text-white">To Family</p>
        </div>
        
        <div class="bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center transform transition hover:scale-105 border-2 border-white/40 cursor-pointer shadow-lg">
          <div class="w-12 h-12 rounded-full bg-green-500 mx-auto flex items-center justify-center mb-2">
            <%= icon("briefcase", class: "w-6 h-6 text-white") %>
          </div>
          <p class="text-sm font-bold text-white">Business</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Form Container -->
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl border-t-8 border-blue-600 overflow-hidden">
    <!-- Steps Indicator - Visual Progress -->
    <div class="flex border-b border-gray-200 dark:border-gray-700">
      <div class="flex-1 text-center p-4 bg-blue-50 dark:bg-blue-900/20 border-b-4 border-blue-600 dark:border-blue-500">
        <div class="w-10 h-10 rounded-full bg-blue-600 mx-auto flex items-center justify-center mb-2">
          <span class="text-lg font-bold text-white">1</span>
        </div>
        <p class="text-sm font-bold text-blue-800 dark:text-blue-300">Who & How Much</p>
      </div>
      <div class="flex-1 text-center p-4">
        <div class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 mx-auto flex items-center justify-center mb-2">
          <span class="text-lg font-bold text-gray-500 dark:text-gray-400">2</span>
        </div>
        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Confirm</p>
      </div>
      <div class="flex-1 text-center p-4">
        <div class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 mx-auto flex items-center justify-center mb-2">
          <span class="text-lg font-bold text-gray-500 dark:text-gray-400">3</span>
        </div>
        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Complete</p>
      </div>
    </div>

    <!-- Form Content -->
    <div class="p-6 md:p-8">
      <% if flash[:success].present? %>
        <div class="mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg">
          <div class="flex">
            <div class="flex-shrink-0">
              <%= icon("check-circle", class: "h-8 w-8 text-green-500") %>
            </div>
            <div class="ml-3">
              <p class="text-lg font-medium text-green-800 dark:text-green-300"><%= flash[:success] %></p>
            </div>
          </div>
        </div>
      <% end %>

      <%= form_with url: transfers_path, method: :post, class: "space-y-8", data: { turbo: false, transfer_target: "transferForm" } do |f| %>
        <!-- Recipient Section - Visual with Photos -->
        <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-xl border border-blue-100 dark:border-blue-900">
          <div class="flex items-center mb-4">
            <div class="w-14 h-14 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center mr-4 shadow-md">
              <%= icon("user", class: "w-8 h-8 text-blue-600 dark:text-blue-400") %>
            </div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">Who are you sending money to?</h3>
          </div>

          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
              <%= icon "search", class: "h-6 w-6 text-blue-500" %>
            </div>
            <%= f.text_field :recipient, value: @recipient_name || flash[:recipient_attempt], class: "form-input block w-full pl-14 py-4 text-lg rounded-xl border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-600 focus:border-blue-500 dark:focus:border-blue-600 shadow-md", placeholder: "Phone number, email, or username", data: { transfer_target: "accountNumber", action: "input->transfer#accountNumberChanged" } %>
            <%= f.hidden_field :recipient_name, data: { transfer_target: "accountName" } %>
          </div>
          
          <div class="flex items-center mt-3 p-3 bg-white dark:bg-gray-800 rounded-lg shadow-inner">
            <span class="w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center mr-2">
              <%= icon("info", class: "w-5 h-5 text-yellow-600") %>
            </span>
            <p class="text-md text-gray-700 dark:text-gray-300">
              Enter your friend's phone number (e.g. 055-123-4567)
            </p>
          </div>

          <% if flash[:error] && flash[:error].include?("No user found") %>
            <div class="mt-4 p-4 bg-amber-50 dark:bg-amber-900/20 border-2 border-amber-300 dark:border-amber-800 rounded-lg shadow-md">
              <div class="flex items-start">
                <div class="flex-shrink-0">
                  <%= icon("alert-triangle", class: "h-8 w-8 text-amber-500") %>
                </div>
                <div class="ml-3">
                  <h3 class="text-lg font-bold text-amber-800 dark:text-amber-300">Cannot Find This Person</h3>
                  <div class="mt-2 text-md text-amber-700 dark:text-amber-400">
                    <p><%= flash[:error] %></p>
                  </div>
                  <div class="mt-4">
                    <a href="#" class="flex items-center text-md font-medium text-amber-800 dark:text-amber-300 bg-amber-200 dark:bg-amber-900 hover:bg-amber-300 dark:hover:bg-amber-800 px-4 py-2 rounded-lg shadow-sm">
                      <%= icon("user-plus", class: "w-5 h-5 mr-2") %>
                      Invite this person to join
                    </a>
                  </div>
                </div>
              </div>
            </div>
          <% end %>

          <!-- Recent Recipients - Visual Grid with Photos -->
          <% if @recent_recipients.present? %>
            <div class="mt-6">
              <h4 class="text-lg font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center">
                <%= icon("clock", class: "w-5 h-5 mr-2 text-blue-500") %>
                People You Recently Sent Money To
              </h4>

              <div class="grid grid-cols-2 sm:grid-cols-3 gap-4" data-transaction-form-target="recentRecipients">
                <% @recent_recipients.each do |recipient| %>
                  <button type="button" class="bg-white dark:bg-gray-700 rounded-xl shadow-md hover:shadow-lg transition-all p-4 text-center border-2 hover:border-blue-500 border-transparent" data-action="click->transaction-form#selectRecipient" data-recipient="<%= recipient.phone %>">
                    <% if recipient.avatar.attached? %>
                      <%= image_tag recipient.avatar.variant(resize_to_fill: [72, 72]), class: "h-16 w-16 mx-auto rounded-full mb-3 border-4 border-white dark:border-gray-800 shadow-md" %>
                    <% else %>
                      <div class="h-16 w-16 rounded-full mx-auto bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center mb-3 border-4 border-white dark:border-gray-800 shadow-md">
                        <span class="text-2xl font-bold text-white"><%= recipient.display_name[0].upcase %></span>
                      </div>
                    <% end %>
                    <p class="text-lg font-bold text-gray-800 dark:text-gray-200"><%= recipient.display_name %></p>
                    <p class="text-sm text-gray-500 dark:text-gray-400 truncate w-full"><%= recipient.phone || recipient.email %></p>
                  </button>
                <% end %>

                <!-- Add New Recipient Button -->
                <button type="button" class="bg-gray-100 dark:bg-gray-800 rounded-xl p-4 text-center border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all">
                  <div class="h-16 w-16 rounded-full mx-auto bg-gray-200 dark:bg-gray-700 flex items-center justify-center mb-3 shadow-md">
                    <%= icon("plus", class: "h-8 w-8 text-gray-500 dark:text-gray-400") %>
                  </div>
                  <p class="text-lg font-bold text-gray-700 dark:text-gray-300">Add New Person</p>
                </button>
              </div>
            </div>
          <% end %>
        </div>

        <!-- Amount Section - Visual with Money Icons -->
        <div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-xl border border-green-100 dark:border-green-900">
          <div class="flex items-center mb-4">
            <div class="w-14 h-14 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center mr-4 shadow-md">
              <%= icon("dollar-sign", class: "w-8 h-8 text-green-600 dark:text-green-400") %>
            </div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">How much money do you want to send?</h3>
          </div>

          <!-- Visual Balance Display -->
          <div class="mb-5 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md flex items-center">
            <div class="w-12 h-12 rounded-full bg-green-600 flex items-center justify-center mr-3">
              <%= icon("wallet", class: "w-6 h-6 text-white") %>
            </div>
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400">Your Balance:</p>
              <p class="text-xl font-bold text-gray-900 dark:text-white"><%= @wallet.formatted_balance %></p>
            </div>
          </div>

          <!-- Very Visual Amount Input -->
          <div class="relative mb-6">
            <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none">
              <div class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center">
                <span class="text-xl font-bold text-green-600 dark:text-green-400">₵</span>
              </div>
            </div>
            <%= f.number_field :amount, step: "0.01", min: "1", max: @wallet.balance, class: "form-input block w-full pl-20 py-6 text-3xl font-bold rounded-xl border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-green-500 dark:focus:ring-green-600 focus:border-green-500 dark:focus:border-green-600 shadow-md", placeholder: "0", data: { transfer_target: "amount", action: "input->transfer#amountChanged" } %>
          </div>

          <!-- Visual Quick Amount Buttons with Money Bills -->
          <div class="grid grid-cols-3 sm:grid-cols-5 gap-3">
            <button type="button" class="quick-amount-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-green-500" data-amount="10" data-transfer-target="quickAmount" data-action="click->transfer#selectQuickAmount">
              <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-1">
                <span class="text-lg font-bold text-white">₵10</span>
              </div>
              <span class="text-lg font-bold text-gray-700 dark:text-gray-300">Small</span>
            </button>
            
            <button type="button" class="quick-amount-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-green-500" data-amount="50" data-transfer-target="quickAmount" data-action="click->transfer#selectQuickAmount">
              <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-1">
                <span class="text-lg font-bold text-white">₵50</span>
              </div>
              <span class="text-lg font-bold text-gray-700 dark:text-gray-300">Fuel</span>
            </button>
            
            <button type="button" class="quick-amount-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-green-500" data-amount="100" data-transfer-target="quickAmount" data-action="click->transfer#selectQuickAmount">
              <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-1">
                <span class="text-lg font-bold text-white">₵100</span>
              </div>
              <span class="text-lg font-bold text-gray-700 dark:text-gray-300">Medium</span>
            </button>
            
            <button type="button" class="quick-amount-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-green-500" data-amount="200" data-transfer-target="quickAmount" data-action="click->transfer#selectQuickAmount">
              <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-1">
                <span class="text-lg font-bold text-white">₵200</span>
              </div>
              <span class="text-lg font-bold text-gray-700 dark:text-gray-300">Rent</span>
            </button>
            
            <button type="button" class="quick-amount-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-green-500" data-amount="500" data-transfer-target="quickAmount" data-action="click->transfer#selectQuickAmount">
              <div class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-1">
                <span class="text-lg font-bold text-white">₵500</span>
              </div>
              <span class="text-lg font-bold text-gray-700 dark:text-gray-300">Large</span>
            </button>
          </div>
        </div>

        <!-- Description Section - Visual with Notes -->
        <div class="bg-indigo-50 dark:bg-indigo-900/20 p-6 rounded-xl border border-indigo-100 dark:border-indigo-900">
          <div class="flex items-center mb-4">
            <div class="w-14 h-14 bg-indigo-100 dark:bg-indigo-800 rounded-full flex items-center justify-center mr-4 shadow-md">
              <%= icon("message-square", class: "w-8 h-8 text-indigo-600 dark:text-indigo-400") %>
            </div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">Why are you sending this money?</h3>
          </div>

          <!-- Visual Buttons for Common Reasons -->
          <div class="grid grid-cols-3 sm:grid-cols-5 gap-3 mb-5">
            <button type="button" class="reason-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-indigo-500" data-reason="Rent" data-action="click->transfer#selectReason">
              <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-800 flex items-center justify-center mb-1">
                <%= icon("home", class: "w-5 h-5 text-indigo-600 dark:text-indigo-400") %>
              </div>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Rent</span>
            </button>
            
            <button type="button" class="reason-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-indigo-500" data-reason="Bills" data-action="click->transfer#selectReason">
              <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-800 flex items-center justify-center mb-1">
                <%= icon("file-text", class: "w-5 h-5 text-indigo-600 dark:text-indigo-400") %>
              </div>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Bills</span>
            </button>
            
            <button type="button" class="reason-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-indigo-500" data-reason="Food" data-action="click->transfer#selectReason">
              <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-800 flex items-center justify-center mb-1">
                <%= icon("coffee", class: "w-5 h-5 text-indigo-600 dark:text-indigo-400") %>
              </div>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Food</span>
            </button>
            
            <button type="button" class="reason-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-indigo-500" data-reason="Gift" data-action="click->transfer#selectReason">
              <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-800 flex items-center justify-center mb-1">
                <%= icon("gift", class: "w-5 h-5 text-indigo-600 dark:text-indigo-400") %>
              </div>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Gift</span>
            </button>
            
            <button type="button" class="reason-button bg-white dark:bg-gray-700 rounded-xl p-3 flex flex-col items-center shadow-md hover:shadow-lg transform hover:scale-105 transition-all border-2 border-transparent hover:border-indigo-500" data-reason="Other" data-action="click->transfer#selectReason">
              <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-800 flex items-center justify-center mb-1">
                <%= icon("plus", class: "w-5 h-5 text-indigo-600 dark:text-indigo-400") %>
              </div>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Other</span>
            </button>
          </div>

          <div class="relative rounded-xl shadow-md">
            <div class="absolute top-4 left-4 flex items-start pointer-events-none">
              <%= icon "edit-3", class: "h-6 w-6 text-indigo-500" %>
            </div>
            <%= f.text_area :description, rows: 3, class: "form-textarea block w-full pl-14 py-4 text-lg rounded-xl border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-600 focus:border-indigo-500 dark:focus:border-indigo-600 shadow-md", placeholder: "Write a note (optional)...", data: { transfer_target: "note" } %>
          </div>
          
          <div class="flex items-center mt-3 p-3 bg-white dark:bg-gray-800 rounded-lg shadow-inner">
            <span class="w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center mr-2">
              <%= icon("info", class: "w-5 h-5 text-yellow-600") %>
            </span>
            <p class="text-md text-gray-700 dark:text-gray-300">
              The person will see this message with your money
            </p>
          </div>
        </div>

        <!-- Visual Summary Card -->
        <div class="bg-gray-50 dark:bg-gray-750 rounded-xl p-6 shadow-md border-2 border-gray-200 dark:border-gray-700" data-transfer-target="summary">
          <h4 class="text-xl font-bold text-gray-900 dark:text-white mb-6 text-center">
            Your Transfer Summary
          </h4>

          <!-- Visual Recipient Information -->
          <div class="mb-6 flex items-center justify-center">
            <div class="w-16 h-16 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mr-3 shadow-md">
              <span data-transfer-target="recipientInitial" class="text-2xl font-bold text-blue-600 dark:text-blue-400">?</span>
            </div>
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400">Sending to:</p>
              <p class="text-xl font-bold text-gray-900 dark:text-white" data-transfer-target="recipientName">Select a recipient</p>
              <p class="text-sm text-gray-600 dark:text-gray-400" data-transfer-target="recipientAccount">No account selected</p>
            </div>
          </div>

          <!-- Visual Amount Display -->
          <div class="mb-6 bg-white dark:bg-gray-800 rounded-xl p-4 shadow-inner border border-gray-200 dark:border-gray-700 flex items-center justify-between">
            <div class="flex items-center">
              <%= icon("credit-card", class: "w-6 h-6 mr-2 text-green-500") %>
              <span class="text-lg font-medium text-gray-700 dark:text-gray-300">Amount:</span>
            </div>
            <div class="flex items-center">
              <span class="text-2xl font-bold text-gray-900 dark:text-white" data-transfer-target="displayAmount">₵0.00</span>
            </div>
          </div>

          <!-- Visual Fee Display -->
          <div class="mb-6 bg-white dark:bg-gray-800 rounded-xl p-4 shadow-inner border border-gray-200 dark:border-gray-700 flex items-center justify-between">
            <div class="flex items-center">
              <%= icon("plus", class: "w-6 h-6 mr-2 text-gray-500") %>
              <span class="text-lg font-medium text-gray-700 dark:text-gray-300">
                Service Fee:
                <span class="inline-block ml-1 relative group">
                  <%= icon("help-circle", class: "w-5 h-5 text-gray-400") %>
                  <div class="absolute left-0 -top-2 transform -translate-y-full w-64 bg-white dark:bg-gray-800 rounded-lg shadow-xl p-4 text-sm text-left hidden group-hover:block z-10 border border-gray-200 dark:border-gray-700">
                    <p class="font-semibold mb-1 text-gray-900 dark:text-white">Fee Structure:</p>
                    <ul class="space-y-1 text-gray-600 dark:text-gray-400">
                      <li class="flex items-center">
                        <%= icon("check", class: "w-4 h-4 mr-1 text-green-500") %>
                        No fee for transfers up to ₵200
                      </li>
                      <li class="flex items-center">
                        <%= icon("percent", class: "w-4 h-4 mr-1 text-blue-500") %>
                        0.5% fee for transfers above ₵200
                      </li>
                    </ul>
                  </div>
                </span>
              </span>
            </div>
            <div class="flex items-center">
              <span class="text-2xl font-bold text-gray-900 dark:text-white" data-transfer-target="feeAmount">₵0.00</span>
            </div>
          </div>

          <!-- Visual Total with Prominent Design -->
          <div class="mb-4 bg-blue-600 rounded-xl p-5 shadow-lg text-white flex items-center justify-between">
            <div class="flex items-center">
              <%= icon("check-circle", class: "w-7 h-7 mr-2") %>
              <span class="text-xl font-bold">Total:</span>
            </div>
            <div class="flex items-center">
              <span class="text-3xl font-bold" data-transfer-target="totalAmount">₵0.00</span>
            </div>
          </div>

          <!-- Security Features - Visual Icons -->
          <div class="flex justify-around mt-6">
            <div class="flex flex-col items-center">
              <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400 mb-2">
                <%= icon("shield", class: "w-6 h-6") %>
              </div>
              <span class="text-xs font-medium text-gray-700 dark:text-gray-300">Safe &amp; Secure</span>
            </div>
            
            <div class="flex flex-col items-center">
              <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 mb-2">
                <%= icon("zap", class: "w-6 h-6") %>
              </div>
              <span class="text-xs font-medium text-gray-700 dark:text-gray-300">Instant Transfer</span>
            </div>
            
            <div class="flex flex-col items-center">
              <div class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400 mb-2">
                <%= icon("repeat", class: "w-6 h-6") %>
              </div>
              <span class="text-xs font-medium text-gray-700 dark:text-gray-300">24/7 Support</span>
            </div>
          </div>

          <!-- PIN Indicator (hidden by default, shown via JS) -->
          <div id="pin-required-indicator" class="mt-4 p-3 bg-amber-100 dark:bg-amber-900/30 rounded-lg border border-amber-200 dark:border-amber-800 flex items-center hidden">
            <div class="w-10 h-10 rounded-full bg-amber-200 dark:bg-amber-800 flex items-center justify-center mr-3">
              <%= icon("lock", class: "w-5 h-5 text-amber-600 dark:text-amber-400") %>
            </div>
            <div>
              <p class="text-sm font-bold text-amber-800 dark:text-amber-300">PIN Verification Required</p>
              <p class="text-xs text-amber-700 dark:text-amber-400">For security, you'll need to enter your PIN</p>
            </div>
          </div>
        </div>

        <!-- PIN Verification Section (hidden by default) -->
        <div class="hidden" data-transfer-target="pinContainer">
          <div class="border-2 border-blue-300 dark:border-blue-800 rounded-xl p-6 bg-blue-50 dark:bg-blue-900/20 shadow-md">
            <div class="flex flex-col items-center mb-6">
              <div class="w-16 h-16 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center mb-3 shadow-md">
                <%= icon("lock", class: "w-10 h-10 text-blue-600 dark:text-blue-400") %>
              </div>
              <h3 class="text-xl font-bold text-gray-900 dark:text-white text-center">Enter Your PIN</h3>
              <p class="text-md text-gray-600 dark:text-gray-400 text-center mt-2">
                For security, please enter your 4-digit PIN
              </p>
            </div>

            <div class="flex justify-center mb-6">
              <div class="flex space-x-3">
                <input type="password" maxlength="1" class="w-14 h-14 text-center text-2xl font-bold border-2 border-blue-300 dark:border-blue-700 rounded-lg shadow-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-transfer-target="pinInput" data-action="input->transfer#moveFocus">
                <input type="password" maxlength="1" class="w-14 h-14 text-center text-2xl font-bold border-2 border-blue-300 dark:border-blue-700 rounded-lg shadow-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-transfer-target="pinInput" data-action="input->transfer#moveFocus">
                <input type="password" maxlength="1" class="w-14 h-14 text-center text-2xl font-bold border-2 border-blue-300 dark:border-blue-700 rounded-lg shadow-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-transfer-target="pinInput" data-action="input->transfer#moveFocus">
                <input type="password" maxlength="1" class="w-14 h-14 text-center text-2xl font-bold border-2 border-blue-300 dark:border-blue-700 rounded-lg shadow-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-transfer-target="pinInput">
              </div>
            </div>

            <!-- PIN Error Message (hidden by default) -->
            <div class="mb-6 hidden" data-transfer-target="pinError">
              <div class="p-4 bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-lg">
                <div class="flex items-center">
                  <div class="flex-shrink-0">
                    <%= icon("alert-triangle", class: "h-8 w-8 text-red-500") %>
                  </div>
                  <div class="ml-3">
                    <h3 class="text-lg font-bold text-red-800 dark:text-red-300">Wrong PIN</h3>
                    <p class="text-md text-red-700 dark:text-red-400">
                      The PIN you entered is incorrect. Please try again.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <div class="flex justify-evenly">
              <button type="button" class="bg-white dark:bg-gray-700 py-3 px-6 rounded-lg shadow-md hover:bg-gray-100 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium flex items-center transition-colors" data-action="transfer#cancelPin">
                <%= icon("x", class: "w-5 h-5 mr-2 text-red-500") %>
                Cancel
              </button>
              
              <button type="button" class="bg-gray-200 dark:bg-gray-600 py-3 px-6 rounded-lg shadow-md hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-300 font-medium flex items-center transition-colors" data-action="transfer#resetPin">
                <%= icon("refresh-cw", class: "w-5 h-5 mr-2 text-blue-500") %>
                Reset PIN
              </button>
            </div>
          </div>
        </div>

        <!-- Submit Button Section - Visual with Icons -->
        <div class="pt-6">
          <div class="flex flex-col gap-4">
            <button type="submit" class="relative overflow-hidden w-full py-5 px-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white text-xl font-bold rounded-xl shadow-xl hover:shadow-2xl transform transition-all duration-300 hover:-translate-y-1 focus:outline-none focus:ring-4 focus:ring-blue-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center" data-transfer-target="submitButton" data-action="click->transfer#submitTransfer">
              <%= icon("send", class: "w-7 h-7 mr-3") %>
              Send Money Now
              <span class="absolute right-0 top-0 h-full w-12 bg-white/20 skew-x-[30deg] transform translate-x-20 transition-transform duration-1000 ease-out group-hover:translate-x-[-8rem]"></span>
            </button>
            
            <a href="<%= wallet_path %>" class="w-full py-4 px-6 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-lg font-medium rounded-xl shadow-md hover:bg-gray-100 dark:hover:bg-gray-700 border border-gray-300 dark:border-gray-600 transition-colors flex items-center justify-center">
              <%= icon("x", class: "w-6 h-6 mr-2 text-red-500") %>
              Cancel Transfer
            </a>

            <!-- Loading Indicator (hidden by default) -->
            <div class="hidden w-full py-5 px-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white text-xl font-bold rounded-xl shadow-xl" data-transfer-target="loadingIndicator">
              <div class="flex items-center justify-center">
                <svg class="animate-spin -ml-1 mr-3 h-7 w-7 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Processing Your Transfer...
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<% content_for :page_helpers do %>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Handle reason button selection
      const reasonButtons = document.querySelectorAll('.reason-button');
      const noteField = document.querySelector('[data-transfer-target="note"]');
      
      reasonButtons.forEach(button => {
        button.addEventListener('click', function() {
          const reason = this.dataset.reason;
          
          // Remove active class from all buttons
          reasonButtons.forEach(btn => {
            btn.classList.remove('border-indigo-500');
            btn.classList.add('border-transparent');
          });
          
          // Add active class to selected button
          this.classList.remove('border-transparent');
          this.classList.add('border-indigo-500');
          
          // Set the reason in the textarea
          noteField.value = reason;
        });
      });
      
      // Handle quick amount button selection
      const quickAmountButtons = document.querySelectorAll('.quick-amount-button');
      const amountField = document.querySelector('[data-transfer-target="amount"]');
      
      quickAmountButtons.forEach(button => {
        button.addEventListener('click', function() {
          const amount = this.dataset.amount;
          
          // Remove active class from all buttons
          quickAmountButtons.forEach(btn => {
            btn.classList.remove('border-green-500');
            btn.classList.add('border-transparent');
          });
          
          // Add active class to selected button
          this.classList.remove('border-transparent');
          this.classList.add('border-green-500');
          
          // Set the amount in the input field
          amountField.value = amount;
          
          // Trigger the input event to update summary
          const event = new Event('input', { bubbles: true });
          amountField.dispatchEvent(event);
        });
      });
    });
  </script>
<% end %>
