<div class="container mx-auto px-4 py-8">
  <div class="mb-6">
    <div class="flex items-center">
      <%= link_to transactions_path, class: "flex items-center justify-center w-10 h-10 rounded-full bg-lime-100 text-lime-600 hover:bg-lime-200 transition-colors mr-3" do %>
        <%= icon "arrow-left", class: "w-5 h-5" %>
      <% end %>
      <h1 class="text-2xl font-bold text-gray-900 dark:text-white">
        New <%= @transaction_type.capitalize %> Transaction
      </h1>
    </div>
  </div>

  <!-- Transaction Type Selection Cards - More Visual Approach -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
    <% transaction_types = ['deposit', 'withdrawal', 'transfer', 'payment'] %>
    <% transaction_types.each do |type| %>
      <%= link_to new_transaction_path(type: type), class: "bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow border-2 #{@transaction_type == type ? 'border-lime-500' : 'border-transparent'}" do %>
        <div class="<%= transaction_type_header_class(type) %> p-4 text-center">
          <div class="inline-flex items-center justify-center <%= transaction_type_icon_class(type) %> mx-auto mb-2">
            <%= transaction_type_icon(type) %>
          </div>
          <h3 class="text-xl font-bold text-white"><%= transaction_type_title(type).split.first %></h3>
        </div>
        <div class="p-3 text-center">
          <% case type %>
          <% when 'deposit' %>
            <img src="<%= asset_path('mobile_payment.jpg') %>" alt="Deposit Money" class="w-12 h-12 mx-auto object-cover rounded-full mb-2">
          <% when 'withdrawal' %>
            <img src="<%= asset_path('step3-wallet.png') %>" alt="Withdraw Money" class="w-12 h-12 mx-auto object-cover rounded-full mb-2">
          <% when 'transfer' %>
            <img src="<%= asset_path('user2.png') %>" alt="Transfer Money" class="w-12 h-12 mx-auto object-cover rounded-full mb-2">
          <% when 'payment' %>
            <img src="<%= asset_path('qr-code.svg') %>" alt="Make Payment" class="w-12 h-12 mx-auto object-cover rounded-full mb-2">
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden border-t-8 <%= transaction_border_color(@transaction_type) %>">
    <div class="<%= transaction_type_header_class(@transaction_type) %>">
      <div class="p-6">
        <div class="flex flex-col md:flex-row items-center text-center md:text-left">
          <div class="<%= transaction_type_icon_class(@transaction_type) %> w-20 h-20 mx-auto md:mx-0">
            <%= transaction_type_icon(@transaction_type) %>
          </div>
          <div class="md:ml-6 mt-4 md:mt-0">
            <h2 class="text-2xl font-bold text-white"><%= transaction_type_title(@transaction_type) %></h2>
            <p class="text-white text-opacity-90 mt-2">
              <%= transaction_type_description(@transaction_type) %>
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="p-6">
      <%= form_with(model: @transaction, url: transactions_path, local: true, class: "space-y-6") do |form| %>
        <%= form.hidden_field :transaction_type, value: @transaction_type %>

        <% case @transaction_type %>
        <% when 'deposit' %>
          <!-- Deposit Form Fields - More Visual -->
          <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-100 dark:border-green-800">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <label for="amount" class="block text-lg font-medium text-gray-700 dark:text-gray-300">How much do you want to deposit?</label>
            </div>
            <div class="mt-1 relative rounded-md shadow-sm">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <span class="text-gray-500 sm:text-sm text-xl"><%= current_user.wallet.currency_symbol %></span>
              </div>
              <%= form.number_field :amount, step: '0.01', min: '0.01', required: true, 
                  class: "block w-full pl-10 pr-12 py-4 text-xl border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-green-500 focus:border-green-500" %>
            </div>
          </div>

          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                </svg>
              </div>
              <label for="payment_method" class="block text-lg font-medium text-gray-700 dark:text-gray-300">How do you want to pay?</label>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
              <% payment_method_options.each do |label, value| %>
                <div>
                  <label class="payment-method-card cursor-pointer block bg-white dark:bg-gray-800 p-3 rounded-lg text-center border-2 hover:border-blue-500 <%= form.object.payment_method == value ? 'border-blue-500' : 'border-gray-200 dark:border-gray-700' %>">
                    <%= form.radio_button :payment_method, value, class: "sr-only payment-method-input" %>
                    <div class="mb-2">
                      <% case value %>
                      <% when 'mobile_money' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
                        </svg>
                      <% when 'bank_transfer' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                      <% when 'card_payment' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                        </svg>
                      <% when 'cash' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z" />
                        </svg>
                      <% end %>
                    </div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white"><%= label %></div>
                  </label>
                </div>
              <% end %>
            </div>
          </div>

          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-purple-100 dark:bg-purple-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
              </div>
              <label for="provider" class="block text-lg font-medium text-gray-700 dark:text-gray-300">Select Provider</label>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
              <% provider_options_for(@transaction_type).each do |label, value| %>
                <div>
                  <label class="provider-card cursor-pointer block bg-white dark:bg-gray-800 p-3 rounded-lg text-center border-2 hover:border-purple-500 <%= form.object.provider == value ? 'border-purple-500' : 'border-gray-200 dark:border-gray-700' %>">
                    <%= form.radio_button :provider, value, class: "sr-only provider-input" %>
                    <div class="mb-2">
                      <% case value %>
                      <% when 'MTN' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-yellow-500 flex items-center justify-center">
                          <span class="text-white font-bold">MTN</span>
                        </div>
                      <% when 'Vodafone' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-red-500 flex items-center justify-center">
                          <span class="text-white font-bold">V</span>
                        </div>
                      <% when 'AirtelTigo' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-blue-500 flex items-center justify-center">
                          <span class="text-white font-bold">AT</span>
                        </div>
                      <% when 'GCB' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-green-500 flex items-center justify-center">
                          <span class="text-white font-bold">GCB</span>
                        </div>
                      <% when 'Ecobank' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-blue-500 flex items-center justify-center">
                          <span class="text-white font-bold">ECO</span>
                        </div>
                      <% when 'Fidelity' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-purple-500 flex items-center justify-center">
                          <span class="text-white font-bold">FID</span>
                        </div>
                      <% when 'Visa' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-blue-700 flex items-center justify-center">
                          <span class="text-white font-bold">VISA</span>
                        </div>
                      <% when 'Mastercard' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-red-700 flex items-center justify-center">
                          <span class="text-white font-bold">MC</span>
                        </div>
                      <% else %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-gray-500 flex items-center justify-center">
                          <span class="text-white font-bold">?</span>
                        </div>
                      <% end %>
                    </div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white"><%= label %></div>
                  </label>
                </div>
              <% end %>
            </div>
          </div>

        <% when 'withdrawal' %>
          <!-- Withdrawal Form Fields - More Visual -->
          <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-100 dark:border-red-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-red-100 dark:bg-red-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600 dark:text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <label for="amount" class="block text-lg font-medium text-gray-700 dark:text-gray-300">How much do you want to withdraw?</label>
            </div>
            <div class="mt-1 relative rounded-md shadow-sm">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <span class="text-gray-500 sm:text-sm text-xl"><%= current_user.wallet.currency_symbol %></span>
              </div>
              <%= form.number_field :amount, step: '0.01', min: '0.01', max: current_user.wallet.balance, required: true, 
                  class: "block w-full pl-10 pr-12 py-4 text-xl border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-red-500 focus:border-red-500" %>
            </div>
            <div class="flex items-center mt-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-md border border-blue-100 dark:border-blue-800">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <p class="text-md text-blue-800 dark:text-blue-200">Available balance: <span class="font-bold"><%= current_user.wallet.currency_symbol %><%= number_with_delimiter(current_user.wallet.balance, delimiter: ',') %></span></p>
            </div>
          </div>

          <!-- Payment Method Selector - Visual with Icons -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                </svg>
              </div>
              <label for="payment_method" class="block text-lg font-medium text-gray-700 dark:text-gray-300">How do you want to receive your money?</label>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
              <% payment_method_options.each do |label, value| %>
                <div>
                  <label class="payment-method-card cursor-pointer block bg-white dark:bg-gray-800 p-3 rounded-lg text-center border-2 hover:border-blue-500 <%= form.object.payment_method == value ? 'border-blue-500' : 'border-gray-200 dark:border-gray-700' %>">
                    <%= form.radio_button :payment_method, value, class: "sr-only payment-method-input" %>
                    <div class="mb-2">
                      <% case value %>
                      <% when 'mobile_money' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
                        </svg>
                      <% when 'bank_transfer' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                      <% when 'card_payment' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                        </svg>
                      <% when 'cash' %>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z" />
                        </svg>
                      <% end %>
                    </div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white"><%= label %></div>
                  </label>
                </div>
              <% end %>
            </div>
          </div>

          <!-- Provider Selection with Visual Elements -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-purple-100 dark:bg-purple-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
              </div>
              <label for="provider" class="block text-lg font-medium text-gray-700 dark:text-gray-300">Select Provider</label>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
              <% provider_options_for(@transaction_type).each do |label, value| %>
                <div>
                  <label class="provider-card cursor-pointer block bg-white dark:bg-gray-800 p-3 rounded-lg text-center border-2 hover:border-purple-500 <%= form.object.provider == value ? 'border-purple-500' : 'border-gray-200 dark:border-gray-700' %>">
                    <%= form.radio_button :provider, value, class: "sr-only provider-input" %>
                    <div class="mb-2">
                      <% case value %>
                      <% when 'MTN' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-yellow-500 flex items-center justify-center">
                          <span class="text-white font-bold">MTN</span>
                        </div>
                      <% when 'Vodafone' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-red-500 flex items-center justify-center">
                          <span class="text-white font-bold">V</span>
                        </div>
                      <% when 'AirtelTigo' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-blue-500 flex items-center justify-center">
                          <span class="text-white font-bold">AT</span>
                        </div>
                      <% when 'GCB' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-green-500 flex items-center justify-center">
                          <span class="text-white font-bold">GCB</span>
                        </div>
                      <% when 'Ecobank' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-blue-500 flex items-center justify-center">
                          <span class="text-white font-bold">ECO</span>
                        </div>
                      <% when 'Fidelity' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-purple-500 flex items-center justify-center">
                          <span class="text-white font-bold">FID</span>
                        </div>
                      <% when 'Visa' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-blue-700 flex items-center justify-center">
                          <span class="text-white font-bold">VISA</span>
                        </div>
                      <% when 'Mastercard' %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-red-700 flex items-center justify-center">
                          <span class="text-white font-bold">MC</span>
                        </div>
                      <% else %>
                        <div class="w-10 h-10 mx-auto rounded-full bg-gray-500 flex items-center justify-center">
                          <span class="text-white font-bold">?</span>
                        </div>
                      <% end %>
                    </div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white"><%= label %></div>
                  </label>
                </div>
              <% end %>
            </div>
          </div>

          <!-- Destination Details with Visual Indicators -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-indigo-100 dark:bg-indigo-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
              </div>
              <label class="block text-lg font-medium text-gray-700 dark:text-gray-300">Where do you want to receive your money?</label>
            </div>
            <%= form.fields_for :destination do |destination_form| %>
              <div class="space-y-4">
                <div class="relative">
                  <div class="flex items-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                    <label for="destination_phone_number" class="block text-md font-medium text-gray-700 dark:text-gray-300">Phone Number (for Mobile Money)</label>
                  </div>
                  <div class="flex">
                    <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-500 dark:text-gray-400 text-sm">
                      +233
                    </span>
                    <%= destination_form.telephone_field :phone_number, class: "flex-1 block w-full py-3 px-4 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-r-md focus:ring-blue-500 focus:border-blue-500", placeholder: "XX XXX XXXX" %>
                  </div>
                </div>
                
                <div class="relative">
                  <div class="flex items-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                    </svg>
                    <label for="destination_account_number" class="block text-md font-medium text-gray-700 dark:text-gray-300">Account Number (for Bank Transfer)</label>
                  </div>
                  <%= destination_form.text_field :account_number, class: "block w-full py-3 px-4 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-green-500 focus:border-green-500", placeholder: "Enter your bank account number" %>
                </div>
                
                <div class="relative">
                  <div class="flex items-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-purple-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <label for="destination_account_name" class="block text-md font-medium text-gray-700 dark:text-gray-300">Account Name (for Bank Transfer)</label>
                  </div>
                  <%= destination_form.text_field :account_name, class: "block w-full py-3 px-4 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-purple-500 focus:border-purple-500", placeholder: "Enter account holder's name" %>
                </div>
              </div>
            <% end %>
          </div>

        <% when 'transfer' %>
          <!-- Transfer Form Fields - More Visual -->
          <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-100 dark:border-blue-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <label for="amount" class="block text-lg font-medium text-gray-700 dark:text-gray-300">How much do you want to send?</label>
            </div>
            <div class="mt-1 relative rounded-md shadow-sm">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <span class="text-gray-500 sm:text-sm text-xl"><%= current_user.wallet.currency_symbol %></span>
              </div>
              <%= form.number_field :amount, step: '0.01', min: '0.01', max: current_user.wallet.balance, required: true, 
                  class: "block w-full pl-10 pr-12 py-4 text-xl border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-blue-500 focus:border-blue-500" %>
            </div>
            <div class="flex items-center mt-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-md border border-blue-100 dark:border-blue-800">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <p class="text-md text-blue-800 dark:text-blue-200">Available balance: <span class="font-bold"><%= current_user.wallet.currency_symbol %><%= number_with_delimiter(current_user.wallet.balance, delimiter: ',') %></span></p>
            </div>
          </div>

          <!-- Recipient Selection with Avatars -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-indigo-100 dark:bg-indigo-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
              </div>
              <label for="destination_wallet_id" class="block text-lg font-medium text-gray-700 dark:text-gray-300">Who do you want to send money to?</label>
            </div>
            
            <div class="grid grid-cols-2 gap-3 mb-4">
              <% recipient_options.each_with_index do |(label, value), index| %>
                <div>
                  <label class="recipient-card cursor-pointer block bg-white dark:bg-gray-800 p-3 rounded-lg border-2 hover:border-indigo-500 <%= form.object.destination_wallet_id == value ? 'border-indigo-500' : 'border-gray-200 dark:border-gray-700' %>">
                    <%= form.radio_button :destination_wallet_id, value, class: "sr-only recipient-input" %>
                    <div class="flex items-center">
                      <div class="flex-shrink-0">
                        <img src="<%= asset_path("user#{index + 1}.png") %>" alt="<%= label.split(' ').first %>" class="h-12 w-12 rounded-full">
                      </div>
                      <div class="ml-3">
                        <div class="text-sm font-medium text-gray-900 dark:text-white"><%= label.split(' ').first(2).join(' ') %></div>
                        <div class="text-xs text-gray-500 dark:text-gray-400"><%= label.split(' ').last %></div>
                      </div>
                    </div>
                  </label>
                </div>
              <% end %>
            </div>
            
            <div class="mt-3 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded-md border border-yellow-100 dark:border-yellow-800">
              <div class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
                <p class="text-sm text-yellow-800 dark:text-yellow-200 font-medium">Make sure you select the correct recipient!</p>
              </div>
            </div>
          </div>

          <!-- Description with Visual Enhancements -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-teal-100 dark:bg-teal-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </div>
              <label for="description" class="block text-lg font-medium text-gray-700 dark:text-gray-300">Why are you sending money? (Optional)</label>
            </div>
            
            <div class="relative">
              <%= form.text_area :description, rows: 3, class: "block w-full py-3 px-4 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-teal-500 focus:border-teal-500", placeholder: "e.g., Rent payment, Birthday gift, etc." %>
              <div class="absolute bottom-3 right-3 text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                </svg>
              </div>
            </div>
          </div>

        <% when 'payment' %>
          <!-- Payment Form Fields - More Visual -->
          <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-100 dark:border-purple-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-purple-100 dark:bg-purple-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <label for="amount" class="block text-lg font-medium text-gray-700 dark:text-gray-300">How much do you want to pay?</label>
            </div>
            <div class="mt-1 relative rounded-md shadow-sm">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <span class="text-gray-500 sm:text-sm text-xl"><%= current_user.wallet.currency_symbol %></span>
              </div>
              <%= form.number_field :amount, step: '0.01', min: '0.01', max: current_user.wallet.balance, required: true, 
                  class: "block w-full pl-10 pr-12 py-4 text-xl border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-purple-500 focus:border-purple-500" %>
            </div>
            <div class="flex items-center mt-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-md border border-blue-100 dark:border-blue-800">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <p class="text-md text-blue-800 dark:text-blue-200">Available balance: <span class="font-bold"><%= current_user.wallet.currency_symbol %><%= number_with_delimiter(current_user.wallet.balance, delimiter: ',') %></span></p>
            </div>
          </div>

          <!-- Merchant Selection with Logos -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-indigo-100 dark:bg-indigo-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                </svg>
              </div>
              <label for="destination_wallet_id" class="block text-lg font-medium text-gray-700 dark:text-gray-300">Which company are you paying?</label>
            </div>
            
            <div class="grid grid-cols-2 gap-3 mb-4">
              <% merchant_options.each_with_index do |(label, value), index| %>
                <div>
                  <label class="merchant-card cursor-pointer block bg-white dark:bg-gray-800 p-3 rounded-lg border-2 hover:border-indigo-500 <%= form.object.destination_wallet_id == value ? 'border-indigo-500' : 'border-gray-200 dark:border-gray-700' %>">
                    <%= form.radio_button :destination_wallet_id, value, class: "sr-only merchant-input" %>
                    <div class="flex items-center">
                      <div class="flex-shrink-0">
                        <% case label %>
                        <% when 'Ghana Water Company' %>
                          <div class="w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center">
                            <span class="text-white font-bold text-xs">GWCL</span>
                          </div>
                        <% when 'Electricity Company of Ghana' %>
                          <div class="w-12 h-12 rounded-full bg-yellow-500 flex items-center justify-center">
                            <span class="text-white font-bold text-xs">ECG</span>
                          </div>
                        <% when 'MTN Ghana' %>
                          <div class="w-12 h-12 rounded-full bg-yellow-500 flex items-center justify-center">
                            <span class="text-white font-bold">MTN</span>
                          </div>
                        <% when 'Vodafone Ghana' %>
                          <div class="w-12 h-12 rounded-full bg-red-500 flex items-center justify-center">
                            <span class="text-white font-bold">V</span>
                          </div>
                        <% else %>
                          <div class="w-12 h-12 rounded-full bg-gray-500 flex items-center justify-center">
                            <span class="text-white font-bold">?</span>
                          </div>
                        <% end %>
                      </div>
                      <div class="ml-3">
                        <div class="text-sm font-medium text-gray-900 dark:text-white"><%= label %></div>
                      </div>
                    </div>
                  </label>
                </div>
              <% end %>
            </div>
          </div>

          <!-- Description Field -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800 mb-6">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-teal-100 dark:bg-teal-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </div>
              <label for="description" class="block text-lg font-medium text-gray-700 dark:text-gray-300">What is this payment for? (Optional)</label>
            </div>
            
            <div class="relative">
              <%= form.text_area :description, rows: 3, class: "block w-full py-3 px-4 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-teal-500 focus:border-teal-500", placeholder: "e.g., Water bill, Electricity bill, etc." %>
              <div class="absolute bottom-3 right-3 text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                </svg>
              </div>
            </div>
          </div>

          <!-- Payment Details with Visual Indicators -->
          <div class="bg-gray-50 dark:bg-gray-900/20 p-4 rounded-lg border border-gray-100 dark:border-gray-800">
            <div class="flex items-center mb-4">
              <div class="w-10 h-10 bg-orange-100 dark:bg-orange-800 rounded-full flex items-center justify-center mr-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-600 dark:text-orange-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
              </div>
              <label class="block text-lg font-medium text-gray-700 dark:text-gray-300">Payment Details</label>
            </div>
            
            <%= form.fields_for :destination do |destination_form| %>
              <div class="space-y-4">
                <div class="relative">
                  <div class="flex items-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-rose-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" />
                    </svg>
                    <label for="destination_reference" class="block text-md font-medium text-gray-700 dark:text-gray-300">Reference Number <span class="text-red-500">*</span></label>
                  </div>
                  <%= destination_form.text_field :reference, required: true, class: "block w-full py-3 px-4 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-rose-500 focus:border-rose-500", placeholder: "Enter your reference/account number" %>
                  <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">E.g., meter number, account number, phone number</p>
                </div>
                
                <div class="relative">
                  <div class="flex items-center mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-amber-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <label for="destination_invoice_number" class="block text-md font-medium text-gray-700 dark:text-gray-300">Invoice Number (Optional)</label>
                  </div>
                  <%= destination_form.text_field :invoice_number, class: "block w-full py-3 px-4 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:ring-amber-500 focus:border-amber-500", placeholder: "Enter invoice number if available" %>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>

        <!-- Submit Buttons - Enhanced with Visual Cues -->
        <div class="mt-8 flex flex-col sm:flex-row justify-center space-y-3 sm:space-y-0 sm:space-x-4">
          <%= link_to transactions_path, class: "flex-1 sm:flex-initial flex items-center justify-center px-6 py-3 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-lime-500" do %>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
            Cancel
          <% end %>
          
          <button type="submit" class="flex-1 sm:flex-initial flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white <%= transaction_submit_class(@transaction_type) %> focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-lime-500">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            Complete <%= @transaction_type.capitalize %>
          </button>
        </div>
      <% end %>
    </div>
  </div>
</div>

<% content_for :helper_methods do %>
  <% # Helper methods for transaction form %>
  <%
    def transaction_type_header_class(type)
      case type
      when 'deposit'
        "bg-gradient-to-r from-green-500 to-green-600"
      when 'withdrawal'
        "bg-gradient-to-r from-red-500 to-red-600"
      when 'transfer'
        "bg-gradient-to-r from-blue-500 to-blue-600"
      when 'payment'
        "bg-gradient-to-r from-purple-500 to-purple-600"
      else
        "bg-gradient-to-r from-gray-500 to-gray-600"
      end
    end

    def transaction_type_icon_class(type)
      base_class = "w-16 h-16 rounded-full flex items-center justify-center"
      case type
      when 'deposit'
        "#{base_class} bg-green-100 text-green-600"
      when 'withdrawal'
        "#{base_class} bg-red-100 text-red-600"
      when 'transfer'
        "#{base_class} bg-blue-100 text-blue-600"
      when 'payment'
        "#{base_class} bg-purple-100 text-purple-600"
      else
        "#{base_class} bg-gray-100 text-gray-600"
      end
    end

    def transaction_type_icon(type)
      case type
      when 'deposit'
        icon("arrow-down-to-line", class: "w-8 h-8")
      when 'withdrawal'
        icon("arrow-up-from-line", class: "w-8 h-8")
      when 'transfer'
        icon("arrow-right-arrow-left", class: "w-8 h-8")
      when 'payment'
        icon("credit-card", class: "w-8 h-8")
      else
        icon("question-mark-circle", class: "w-8 h-8")
      end
    end

    def transaction_border_color(type)
      case type
      when 'deposit'
        "border-green-500"
      when 'withdrawal'
        "border-red-500"
      when 'transfer'
        "border-blue-500"
      when 'payment'
        "border-purple-500"
      else
        "border-gray-500"
      end
    end

    def transaction_submit_class(type)
      case type
      when 'deposit'
        "bg-green-600 hover:bg-green-700"
      when 'withdrawal'
        "bg-red-600 hover:bg-red-700"
      when 'transfer'
        "bg-blue-600 hover:bg-blue-700"
      when 'payment'
        "bg-purple-600 hover:bg-purple-700"
      else
        "bg-lime-600 hover:bg-lime-700"
      end
    end

    def transaction_type_title(type)
      case type
      when 'deposit'
        "Deposit Money"
      when 'withdrawal'
        "Withdraw Money"
      when 'transfer'
        "Transfer Money"
      when 'payment'
        "Make a Payment"
      else
        "New Transaction"
      end
    end

    def transaction_type_description(type)
      case type
      when 'deposit'
        "Add money to your wallet from an external source."
      when 'withdrawal'
        "Withdraw money from your wallet to an external destination."
      when 'transfer'
        "Send money to another user's wallet."
      when 'payment'
        "Pay for goods or services."
      else
        "Create a new transaction."
      end
    end

    def payment_method_options
      [
        ['Mobile Money', 'mobile_money'],
        ['Bank Transfer', 'bank_transfer'],
        ['Card Payment', 'card_payment'],
        ['Cash', 'cash']
      ]
    end

    def provider_options_for(transaction_type)
      case transaction_type
      when 'deposit', 'withdrawal'
        [
          ['MTN Mobile Money', 'MTN'],
          ['Vodafone Cash', 'Vodafone'],
          ['AirtelTigo Money', 'AirtelTigo'],
          ['Ghana Commercial Bank', 'GCB'],
          ['Ecobank', 'Ecobank'],
          ['Fidelity Bank', 'Fidelity'],
          ['Visa', 'Visa'],
          ['Mastercard', 'Mastercard']
        ]
      else
        [
          ['Select Provider', '']
        ]
      end
    end

    def recipient_options
      # In a real application, this would fetch actual recipients
      # For now, we'll use dummy data
      [
        ['John Doe (Wallet ID: 12345)', 1],
        ['Jane Smith (Wallet ID: 67890)', 2],
        ['Kwame Nkrumah (Wallet ID: 24680)', 3]
      ]
    end

    def merchant_options
      # In a real application, this would fetch actual merchants
      # For now, we'll use dummy data
      [
        ['Ghana Water Company', 4],
        ['Electricity Company of Ghana', 5],
        ['MTN Ghana', 6],
        ['Vodafone Ghana', 7]
      ]
    end
  %>
<% end %>

<% content_for :page_scripts do %>
  <script>
    // Add JavaScript to enhance form interactions
    document.addEventListener('DOMContentLoaded', function() {
      // Payment Method Selection
      const paymentMethodCards = document.querySelectorAll('.payment-method-card');
      paymentMethodCards.forEach(card => {
        card.addEventListener('click', function() {
          // Remove active class from all cards
          paymentMethodCards.forEach(c => c.classList.remove('border-blue-500'));
          c.classList.add('border-gray-200', 'dark:border-gray-700');
          
          // Add active class to clicked card
          this.classList.remove('border-gray-200', 'dark:border-gray-700');
          this.classList.add('border-blue-500');
          
          // Check the radio button
          const radio = this.querySelector('input[type="radio"]');
          radio.checked = true;
        });
      });
      
      // Provider Selection
      const providerCards = document.querySelectorAll('.provider-card');
      providerCards.forEach(card => {
        card.addEventListener('click', function() {
          // Remove active class from all cards
          providerCards.forEach(c => {
            c.classList.remove('border-purple-500');
            c.classList.add('border-gray-200', 'dark:border-gray-700');
          });
          
          // Add active class to clicked card
          this.classList.remove('border-gray-200', 'dark:border-gray-700');
          this.classList.add('border-purple-500');
          
          // Check the radio button
          const radio = this.querySelector('input[type="radio"]');
          radio.checked = true;
        });
      });
      
      // Recipient Selection
      const recipientCards = document.querySelectorAll('.recipient-card');
      recipientCards.forEach(card => {
        card.addEventListener('click', function() {
          // Remove active class from all cards
          recipientCards.forEach(c => {
            c.classList.remove('border-indigo-500');
            c.classList.add('border-gray-200', 'dark:border-gray-700');
          });
          
          // Add active class to clicked card
          this.classList.remove('border-gray-200', 'dark:border-gray-700');
          this.classList.add('border-indigo-500');
          
          // Check the radio button
          const radio = this.querySelector('input[type="radio"]');
          radio.checked = true;
        });
      });
      
      // Merchant Selection
      const merchantCards = document.querySelectorAll('.merchant-card');
      merchantCards.forEach(card => {
        card.addEventListener('click', function() {
          // Remove active class from all cards
          merchantCards.forEach(c => {
            c.classList.remove('border-indigo-500');
            c.classList.add('border-gray-200', 'dark:border-gray-700');
          });
          
          // Add active class to clicked card
          this.classList.remove('border-gray-200', 'dark:border-gray-700');
          this.classList.add('border-indigo-500');
          
          // Check the radio button
          const radio = this.querySelector('input[type="radio"]');
          radio.checked = true;
        });
      });
    });
  </script>
<% end %>
